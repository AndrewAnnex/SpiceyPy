[build-system]
requires = ["setuptools >= 46.4.0", "wheel", "numpy", "cython"]
build-backend = "setuptools.build_meta"

[project]
name = 'spiceypy'
dynamic = ["version", "readme"]
description = 'A Python Wrapper for the NAIF CSPICE Toolkit'
requires-python = ">=3.7"
authors = [
    {name = 'Andrew M. Annex', email='ama6fy@virginia.edu'}
]
license = {text = "MIT License"}
keywords = ['spiceypy', 'spice', 'cspice', 'naif', 'jpl', 'space', 'geometry', 'ephemeris']
classifiers = [
     'Development Status :: 5 - Production/Stable',
     'Natural Language :: English',
     'Topic :: Scientific/Engineering',
     'Topic :: Scientific/Engineering :: Astronomy',
     'License :: OSI Approved :: MIT License',
     'Programming Language :: Python :: 3.7',
     'Programming Language :: Python :: 3.8',
     'Programming Language :: Python :: 3.9',
     'Programming Language :: Python :: 3.10',
     'Programming Language :: Python :: 3.11',
     'Operating System :: MacOS :: MacOS X',
     'Operating System :: POSIX :: Linux',
     'Operating System :: POSIX :: BSD :: FreeBSD',
     'Operating System :: Microsoft :: Windows',
]

[project.optional-dependencies]
tests = ['numpy>=1.17.0', 'pytest>=7.0.0', 'pandas>=0.24.0']
dev = ['numpy>=1.17.0', 'pytest>=7.0.0', 'pytest-benchmark', 'pandas>=0.24.0', 'coverage>=5.1.0', 'twine>=3.3.0', 'cython', 'wheel', 'build', 'black']

[project.urls]
'Homepage'      = 'https://github.com/AndrewAnnex/SpiceyPy'
'Repository'    = 'https://github.com/AndrewAnnex/SpiceyPy'
'Source'        = 'https://github.com/AndrewAnnex/SpiceyPy'
'Conda-Forge'   = 'https://anaconda.org/conda-forge/spiceypy'
'Documentation' = 'https://spiceypy.readthedocs.io'
'Bug Tracker'   =  'https://github.com/AndrewAnnex/SpiceyPy/issues'
'Changelog'     = 'https://github.com/AndrewAnnex/SpiceyPy/blob/main/CHANGELOG.md'

[tool.setuptools.dynamic]
version = {attr = "spiceypy.__version__"}
readme = {file = "README.rst"}

[tool.cibuildwheel]
# use build instead of pip to build wheels
build-frontend = "build"
# build libcspice inside cibuildwheel before running python build steps
before-build = """
python {project}/get_spice.py
python {project}/setup.py build_ext -j 2 --inplace
"""
# Only build on CPython 3.11
build = "cp311-*"
# Skip 32-bit builds, pypy, and musllinux
skip = ["*-win32", "*-manylinux_i686", "*-musllinux_i686", "pypy*", "pp*", "*-musllinux_aarch64", "*-musllinux_x86_64"]
# other options
build-verbosity = 2
before-test = [
    "pip install -r ci-requirements.txt"
]
test-command = [
    "coverage run --source {package} -m pytest --pyargs {project}",
]

[tool.coverage.run]
relative_files = true

[tool.coverage.paths]
source = [
    "src/spiceypy/",
    "work/SpiceyPy/SpiceyPy/",
    ]

