[build-system]
requires = ["setuptools >= 42", "wheel"]
build-backend = "setuptools.build_meta"

[tool.cibuildwheel]
# build libcspice inside cibuildwheel before running python build steps
before-all = "python {project}/get_spice.py"
# use build instead of pip to build wheels
build-frontend = "build"
# Only build on CPython 3.9
build = "cp39-*"
# Skip 32-bit builds and pypy
skip = ["*-win32", "*-manylinux_i686", "pypy*"]
# other options
build-verbosity = 2
before-test = "pip install -r ci-requirements.txt"
test-command = [
    "coverage run --source {package} -m pytest --pyargs {project}",
]

[tool.cibuildwheel.macos]
# to start just try to get amd64 working, later we can worry about arm
archs = ["x86_64", "arm64"]

[tool.cibuildwheel.linux]
archs = ["x86_64", "aarch64"]
